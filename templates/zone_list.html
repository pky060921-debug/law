{% extends "layout.html" %}
{% block content %}
<h1>
    {% if mode == 'acquire' %}ğŸ“¥ íšë“ êµ¬ì—­
    {% elif mode == 'review' %}ğŸ”„ ë³µìŠµ êµ¬ì—­
    {% else %}âš¡ ì•½ì–´ êµ¬ì—­{% endif %}
</h1>
<p style="text-align:center; color:#aaa;">
    {% if mode == 'acquire' %}ì•„ì§ ë°°ìš°ì§€ ì•Šì€ ì¹´ë“œë“¤ì…ë‹ˆë‹¤.{% elif mode == 'review' %}ë°˜ë³µí• ìˆ˜ë¡ ì¹´ë“œê°€ ê°•ë ¥í•´ì§‘ë‹ˆë‹¤.{% else %}ì²« ê¸€ìë¥¼ ë³´ê³  ì „ì²´ë¥¼ ë§ì¶”ì„¸ìš”!{% endif %}
</p>

<div style="margin-top:20px;">
    {% if not quests %}
        <div style="text-align:center; padding:50px; color:#7f8c8d;">
            í•™ìŠµí•  ì¹´ë“œê°€ ì—†ìŠµë‹ˆë‹¤.<br>
            {% if mode == 'acquire' %}(ìƒì„± êµ¬ì—­ì—ì„œ íŒŒì¼ì„ ì—…ë¡œë“œí•˜ì„¸ìš”)
            {% else %}(íšë“ êµ¬ì—­ì—ì„œ ë¨¼ì € í•™ìŠµì„ ì™„ë£Œí•˜ì„¸ìš”){% endif %}
        </div>
    {% endif %}

    {% set groups = {} %}
    {% for q in quests %}
        {% set title = q.quest_name.split('-')[0] %}
        {% if title not in groups %}{% set _ = groups.update({title: []}) %}{% endif %}
        {% set _ = groups[title].append(q) %}
    {% endfor %}

    {% for title, items in groups.items() %}
    <details style="margin-bottom:15px; background:#34495e; border-radius:10px; overflow:hidden;">
        <summary style="padding:15px; cursor:pointer; font-weight:bold; color:#f39c12; list-style:none;">
            ğŸ“‚ {{ title }} <span style="color:#bdc3c7; font-size:0.8em;">({{ items|length }}ê°œ)</span>
        </summary>
        <div style="background:#2c3e50; padding:10px;">
            {% for item in items %}
            <form method="POST" style="margin-bottom:5px;">
                <input type="hidden" name="quest_name" value="{{ item.quest_name }}">
                <button type="submit" style="width:100%; text-align:left; background:transparent; border:none; color:#ecf0f1; padding:10px; border-bottom:1px solid #444; cursor:pointer;">
                    ğŸ“„ {{ item.quest_name }}
                    {% if mode != 'acquire' %}
                        <span style="float:right; color:#2ecc71;">Lv.{{ item.level }}</span>
                    {% endif %}
                </button>
            </form>
            {% endfor %}
        </div>
    </details>
    {% endfor %}
</div>
{% endblock %}
