{% extends "layout.html" %}

{% block content %}
<h1>ğŸ­ ë¹ˆì¹¸ ì¹´ë“œ ìƒì„±ì†Œ</h1>
<p style="color:#aaa; text-align:center;">ë²•ë ¹ í…ìŠ¤íŠ¸ íŒŒì¼ì„ ì—…ë¡œë“œí•˜ê±°ë‚˜ ì§ì ‘ ì…ë ¥í•˜ì„¸ìš”.</p>

<div style="display:flex; gap:15px; flex-wrap:wrap; justify-content:center; margin-bottom:20px;">
    <div style="flex:1; min-width:300px; background:#34495e; padding:30px; border-radius:15px; text-align:center; border: 1px solid #7f8c8d;">
        <form method="POST" enctype="multipart/form-data">
            <h3 style="margin-top:0; color:#f39c12;">ğŸ“‚ íŒŒì¼ë¡œ ë§Œë“¤ê¸°</h3>
            <input type="text" name="new_q_name" placeholder="ë²•ë ¹ ì œëª© (ì˜ˆ: í˜•ë²•)" required 
                   style="padding:12px; width:80%; margin-bottom:15px; border-radius:5px; border:none;">
            <br>
            <input type="file" name="new_q_file" accept=".txt" required style="color:white; margin-bottom:15px;">
            <br>
            <button type="submit" style="background:#f39c12; border:none; padding:10px 30px; border-radius:30px; font-weight:bold; cursor:pointer;">
                ìƒì„±í•˜ê¸°
            </button>
        </form>
    </div>

    <div style="flex:1; min-width:300px; background:#34495e; padding:30px; border-radius:15px; text-align:center; border: 1px solid #7f8c8d; display:flex; flex-direction:column; justify-content:center; align-items:center;">
        <h3 style="margin-top:0; color:#2ecc71;">âœï¸ ì§ì ‘ ë§Œë“¤ê¸°</h3>
        <p style="color:#bdc3c7; font-size:0.9rem;">ì›í•˜ëŠ” ë¬¸ì¥ì„ ë¶™ì—¬ë„£ê³ <br>í´ë¦­í•´ì„œ ë¹ˆì¹¸ì„ ëš«ìœ¼ì„¸ìš”!</p>
        <a href="/maker" style="background:#2ecc71; color:white; text-decoration:none; padding:12px 30px; border-radius:30px; font-weight:bold; display:inline-block; margin-top:10px;">
            ì œì‘ê¸° ì—´ê¸°
        </a>
    </div>
</div>

<div style="margin-top:40px;">
    <h3>ğŸ“‚ í˜„ì¬ ë“±ë¡ëœ ë²•ë ¹ ëª©ë¡</h3>
    {% if not quests %}
        <div style="text-align:center; padding:40px; color:#95a5a6; border: 2px dashed #555; border-radius: 10px;">
            <p>ì•„ì§ ë“±ë¡ëœ ì¹´ë“œê°€ ì—†ìŠµë‹ˆë‹¤.</p>
        </div>
    {% else %}
        {% set groups = {} %}
        {% for q in quests %}
            {% set title = q.quest_name.split('-')[0] %}
            {% if title not in groups %}{% set _ = groups.update({title: []}) %}{% endif %}
            {% set _ = groups[title].append(q) %}
        {% endfor %}

        {% for title, items in groups.items() %}
        <div style="background:#2c3e50; padding:15px; margin-bottom:10px; border-radius:10px; display:flex; justify-content:space-between; align-items:center; border:1px solid #444;">
            <div>
                <span style="color:#ecf0f1; font-weight:bold; font-size:1.1rem;">{{ title }}</span>
                <span style="color:#bdc3c7; font-size:0.9rem; margin-left:10px;">(ì´ {{ items|length }}ê°œ)</span>
            </div>
            <form method="POST" style="margin:0;" onsubmit="return confirm('ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?');">
                <input type="hidden" name="delete_group" value="{{ title }}">
                <button style="background:#c0392b; color:white; border:none; padding:8px 15px; border-radius:5px; cursor:pointer;">ì‚­ì œ</button>
            </form>
        </div>
        {% endfor %}
    {% endif %}
</div>
{% endblock %}
